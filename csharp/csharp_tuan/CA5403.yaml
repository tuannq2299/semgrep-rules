rules:
- id: CA5403
  patterns:
    - pattern-inside: |
        using System.Security.Cryptography.X509Certificates;
        ...
    - pattern-either:
        - pattern: |
            public $T $F($X){
              ...
              byte[] $B = new byte[]{...};
              ...
              File.WriteAllBytes($X, $B);
              ...
              new X509Certificate2($X);
              ...
            }
        - pattern: |
            public $T $F($B, $X){
              ...
              char[] $C = new char[] {...};
              ...
              Encoding.ASCII.GetBytes($C, ..., $B, ...);
              ...
              File.WriteAllBytes($X, $B);
              ...
              new X509Certificate2($X);
              ...
            }
        - pattern: |
            public $T $F($X){
              ...
              byte[] $B = Convert.FromBase64String("...");
              ...
              File.WriteAllBytes($X, $B);
              ...
              new X509Certificate2($X);
              ...
            }
        - pattern: |
            public $T $F($X){
              ...
              byte[] $B = Encoding.ASCII.GetBytes("...");
              ...
              File.WriteAllBytes($X, $B);
              ...
              new X509Certificate2($X);
              ...
            }
  message: Do not hard-code certificate
  languages: [csharp]
  metadata:
    cwe: 'CWE-798: Use of Hard-coded Credentials'
    references:
     - https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca5403
  severity: WARNING
