rules:
  - id: CA2361
    severity: WARNING
    languages:
      - csharp
    message: Ensure autogenerated class containing DataSet.ReadXml() is not used with untrusted data
    metadata:
      cwe: "CWE-502: Deserialization of Untrusted Data"
      references:
        - https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/quality-rules/ca2361
    patterns:
      - pattern-inside: |
          protected override void ReadXmlSerializable(...){
            ...
            new global::System.Data.DataSet();
            ...
          }
      - pattern: |
          $S.ReadXml(...);